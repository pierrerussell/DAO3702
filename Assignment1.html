<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="weRready">
<meta name="dcterms.date" content="2026-01-30">

<title>DBA3702 Assignment 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Assignment1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Assignment1_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment1_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment1_files/libs/bootstrap/bootstrap-3a576e2b93a2c127cfaa5245409d9942.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DBA3702 Assignment 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>weRready </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 30, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div style="page-break-after: always;"></div>
<section id="part-1-data-wrangling-with-dplyr-45-points" class="level1">
<h1>Part 1: Data Wrangling with dplyr (45 points)</h1>
<section id="question-1.1-data-exploration-5-points" class="level2">
<h2 class="anchored" data-anchor-id="question-1.1-data-exploration-5-points">Question 1.1: Data Exploration (5 points)</h2>
<section id="a-load-packages-and-read-data" class="level3">
<h3 class="anchored" data-anchor-id="a-load-packages-and-read-data">a) Load packages and read data</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>employees <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/employees.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b-convert-to-tibble-and-display-first-10-rows" class="level3">
<h3 class="anchored" data-anchor-id="b-convert-to-tibble-and-display-first-10-rows">b) Convert to tibble and display first 10 rows</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>employees <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(employees)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(employees, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 8
   employee_id name          department role  years_exp salary performance_score
         &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;             &lt;dbl&gt;
 1           1 Alice Chen    Engineeri… Seni…         8  95000               4.5
 2           2 Bob Martinez  Engineeri… Lead         12 120000               4.8
 3           3 Charlie Kim   Engineeri… Juni…         2  65000               3.8
 4           4 Diana Patel   Engineeri… Seni…         7  92000               4.2
 5           5 Eve Thompson  Engineeri… Mana…        15 140000               4.6
 6           6 Frank Liu     Engineeri… Juni…         1  58000               3.2
 7           7 Grace Okonkwo Engineeri… Seni…         9  98000               4.4
 8           8 Henry Wang    Marketing  Lead         10 105000               4.3
 9           9 Iris Nakamura Marketing  Seni…         6  82000               3.9
10          10 Jack Brown    Marketing  Juni…         2  55000               3.5
# ℹ 40 more rows
# ℹ 1 more variable: projects_completed &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="c-data-summary" class="level3">
<h3 class="anchored" data-anchor-id="c-data-summary">c) Data summary</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows:"</span>, <span class="fu">nrow</span>(employees), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 50 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Columns:"</span>, <span class="fu">ncol</span>(employees), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columns: 8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(employees, typeof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       employee_id               name         department               role 
         "integer"        "character"        "character"        "character" 
         years_exp             salary  performance_score projects_completed 
         "integer"          "integer"           "double"          "integer" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(employees)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  employee_id        name            department            role          
 Min.   : 1.00   Length:50          Length:50          Length:50         
 1st Qu.:13.25   Class :character   Class :character   Class :character  
 Median :25.50   Mode  :character   Mode  :character   Mode  :character  
 Mean   :25.50                                                           
 3rd Qu.:37.75                                                           
 Max.   :50.00                                                           
   years_exp         salary       performance_score projects_completed
 Min.   : 1.00   Min.   : 48000   Min.   :2.900     Min.   : 2.00     
 1st Qu.: 3.00   1st Qu.: 65750   1st Qu.:3.600     1st Qu.: 6.00     
 Median : 6.50   Median : 85000   Median :4.000     Median :11.50     
 Mean   : 6.68   Mean   : 86420   Mean   :3.970     Mean   :12.24     
 3rd Qu.: 9.00   3rd Qu.:101500   3rd Qu.:4.375     3rd Qu.:17.00     
 Max.   :16.00   Max.   :145000   Max.   :4.900     Max.   :30.00     </code></pre>
</div>
</div>
<p>The dataset includes information about 50 employees with 8 variables. This includes basic information, such as employee name and department, as well as quantitative information, such as salary, years of experience, performance scores, and number of projects completed.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-1.2-selecting-and-filtering-8-points" class="level2">
<h2 class="anchored" data-anchor-id="question-1.2-selecting-and-filtering-8-points">Question 1.2: Selecting and Filtering (8 points)</h2>
<section id="d-select-specific-columns" class="level3">
<h3 class="anchored" data-anchor-id="d-select-specific-columns">d) Select specific columns</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, department, role, performance_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 4
   name          department  role    performance_score
   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;               &lt;dbl&gt;
 1 Alice Chen    Engineering Senior                4.5
 2 Bob Martinez  Engineering Lead                  4.8
 3 Charlie Kim   Engineering Junior                3.8
 4 Diana Patel   Engineering Senior                4.2
 5 Eve Thompson  Engineering Manager               4.6
 6 Frank Liu     Engineering Junior                3.2
 7 Grace Okonkwo Engineering Senior                4.4
 8 Henry Wang    Marketing   Lead                  4.3
 9 Iris Nakamura Marketing   Senior                3.9
10 Jack Brown    Marketing   Junior                3.5
# ℹ 40 more rows</code></pre>
</div>
</div>
</section>
<section id="e-filter-performance-4.0" class="level3">
<h3 class="anchored" data-anchor-id="e-filter-performance-4.0">e) Filter performance &gt; 4.0</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>high_performers <span class="ot">&lt;-</span> employees <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(performance_score <span class="sc">&gt;</span> <span class="fl">4.0</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>high_performers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 8
   employee_id name          department role  years_exp salary performance_score
         &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;             &lt;dbl&gt;
 1           1 Alice Chen    Engineeri… Seni…         8  95000               4.5
 2           2 Bob Martinez  Engineeri… Lead         12 120000               4.8
 3           4 Diana Patel   Engineeri… Seni…         7  92000               4.2
 4           5 Eve Thompson  Engineeri… Mana…        15 140000               4.6
 5           7 Grace Okonkwo Engineeri… Seni…         9  98000               4.4
 6           8 Henry Wang    Marketing  Lead         10 105000               4.3
 7          11 Kate Wilson   Marketing  Mana…        14 125000               4.5
 8          14 Nathan Lee    Sales      Lead         11 115000               4.7
 9          15 Olivia Davis  Sales      Seni…         8  88000               4.1
10          18 Rachel Green  Sales      Mana…        13 130000               4.4
# ℹ 13 more rows
# ℹ 1 more variable: projects_completed &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Count:"</span>, <span class="fu">nrow</span>(high_performers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Count: 23</code></pre>
</div>
</div>
</section>
<section id="f-engineeringmarketing-with-5-years-experience" class="level3">
<h3 class="anchored" data-anchor-id="f-engineeringmarketing-with-5-years-experience">f) Engineering/Marketing with &gt; 5 years experience</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((department <span class="sc">==</span> <span class="st">"Engineering"</span> <span class="sc">|</span> department <span class="sc">==</span> <span class="st">"Marketing"</span>) <span class="sc">&amp;</span> years_exp <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 8
   employee_id name          department role  years_exp salary performance_score
         &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;             &lt;dbl&gt;
 1           1 Alice Chen    Engineeri… Seni…         8  95000               4.5
 2           2 Bob Martinez  Engineeri… Lead         12 120000               4.8
 3           4 Diana Patel   Engineeri… Seni…         7  92000               4.2
 4           5 Eve Thompson  Engineeri… Mana…        15 140000               4.6
 5           7 Grace Okonkwo Engineeri… Seni…         9  98000               4.4
 6           8 Henry Wang    Marketing  Lead         10 105000               4.3
 7           9 Iris Nakamura Marketing  Seni…         6  82000               3.9
 8          11 Kate Wilson   Marketing  Mana…        14 125000               4.5
 9          31 Eric Zhang    Engineeri… Seni…         6  88000               4  
10          33 George Park   Marketing  Seni…         7  80000               3.7
11          41 Oscar Rivera  Engineeri… Lead         11 118000               4.5
12          42 Paula Hughes  Engineeri… Mana…        16 145000               4.9
13          43 Quentin Price Marketing  Lead          8 100000               4.1
14          47 Ulrich Weber  Engineeri… Seni…         7  94000               4.2
# ℹ 1 more variable: projects_completed &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="g-select-using-helpers" class="level3">
<h3 class="anchored" data-anchor-id="g-select-using-helpers">g) Select using helpers</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"score"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"p"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 2
   performance_score projects_completed
               &lt;dbl&gt;              &lt;int&gt;
 1               4.5                 15
 2               4.8                 22
 3               3.8                  5
 4               4.2                 12
 5               4.6                 28
 6               3.2                  3
 7               4.4                 16
 8               4.3                 18
 9               3.9                 11
10               3.5                  4
# ℹ 40 more rows</code></pre>
</div>
</div>
<p>There are two columns, <em>performance_score</em> and <em>projects_completed</em>, that meet the given condition.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-1.3-sorting-and-ranking-7-points" class="level2">
<h2 class="anchored" data-anchor-id="question-1.3-sorting-and-ranking-7-points">Question 1.3: Sorting and Ranking (7 points)</h2>
<section id="h-top-5-highest-paid" class="level3">
<h3 class="anchored" data-anchor-id="h-top-5-highest-paid">h) Top 5 highest-paid</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(salary)) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  employee_id name         department  role   years_exp salary performance_score
        &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;      &lt;int&gt;  &lt;int&gt;             &lt;dbl&gt;
1          42 Paula Hughes Engineering Manag…        16 145000               4.9
2           5 Eve Thompson Engineering Manag…        15 140000               4.6
3          28 Bella Moore  Finance     Manag…        14 135000               4.7
4          18 Rachel Green Sales       Manag…        13 130000               4.4
5          11 Kate Wilson  Marketing   Manag…        14 125000               4.5
# ℹ 1 more variable: projects_completed &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="i-sort-by-department-then-performance" class="level3">
<h3 class="anchored" data-anchor-id="i-sort-by-department-then-performance">i) Sort by department then performance</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(department, <span class="fu">desc</span>(performance_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 8
   employee_id name          department role  years_exp salary performance_score
         &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;             &lt;dbl&gt;
 1          42 Paula Hughes  Engineeri… Mana…        16 145000               4.9
 2           2 Bob Martinez  Engineeri… Lead         12 120000               4.8
 3           5 Eve Thompson  Engineeri… Mana…        15 140000               4.6
 4           1 Alice Chen    Engineeri… Seni…         8  95000               4.5
 5          41 Oscar Rivera  Engineeri… Lead         11 118000               4.5
 6           7 Grace Okonkwo Engineeri… Seni…         9  98000               4.4
 7           4 Diana Patel   Engineeri… Seni…         7  92000               4.2
 8          47 Ulrich Weber  Engineeri… Seni…         7  94000               4.2
 9          31 Eric Zhang    Engineeri… Seni…         6  88000               4  
10          32 Fiona O'Brien Engineeri… Juni…         3  68000               3.9
# ℹ 40 more rows
# ℹ 1 more variable: projects_completed &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="j-lowest-salary-in-each-department" class="level3">
<h3 class="anchored" data-anchor-id="j-lowest-salary-in-each-department">j) Lowest salary in each department</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(department, salary) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  employee_id name           department role  years_exp salary performance_score
        &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;             &lt;dbl&gt;
1           6 Frank Liu      Engineeri… Juni…         1  58000               3.2
2          30 Dana Hill      Finance    Juni…         1  55000               3  
3          22 Victor Nguyen  HR         Juni…         1  48000               3.1
4          13 Maya Rodriguez Marketing  Juni…         1  52000               3.3
5          36 Julia Foster   Sales      Juni…         1  53000               2.9
# ℹ 1 more variable: projects_completed &lt;int&gt;</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-1.4-creating-new-variables-10-points" class="level2">
<h2 class="anchored" data-anchor-id="question-1.4-creating-new-variables-10-points">Question 1.4: Creating New Variables (10 points)</h2>
<section id="k-salary-per-year-of-experience" class="level3">
<h3 class="anchored" data-anchor-id="k-salary-per-year-of-experience">k) Salary per year of experience</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">salary_per_year_exp =</span> salary <span class="sc">/</span> years_exp) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, salary, years_exp, salary_per_year_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 4
   name          salary years_exp salary_per_year_exp
   &lt;chr&gt;          &lt;int&gt;     &lt;int&gt;               &lt;dbl&gt;
 1 Alice Chen     95000         8              11875 
 2 Bob Martinez  120000        12              10000 
 3 Charlie Kim    65000         2              32500 
 4 Diana Patel    92000         7              13143.
 5 Eve Thompson  140000        15               9333.
 6 Frank Liu      58000         1              58000 
 7 Grace Okonkwo  98000         9              10889.
 8 Henry Wang    105000        10              10500 
 9 Iris Nakamura  82000         6              13667.
10 Jack Brown     55000         2              27500 
# ℹ 40 more rows</code></pre>
</div>
</div>
</section>
<section id="l-performance-category" class="level3">
<h3 class="anchored" data-anchor-id="l-performance-category">l) Performance category</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>employees_cat <span class="ot">&lt;-</span> employees <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">performance_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    performance_score <span class="sc">&gt;=</span> <span class="fl">4.5</span> <span class="sc">~</span> <span class="st">"Outstanding"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    performance_score <span class="sc">&gt;=</span> <span class="fl">3.5</span> <span class="sc">~</span> <span class="st">"Exceeds Expectations"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    performance_score <span class="sc">&gt;=</span> <span class="fl">2.5</span> <span class="sc">~</span> <span class="st">"Meets Expectations"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Needs Improvement"</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>employees_cat <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, performance_score, performance_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 3
   name          performance_score performance_category
   &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;               
 1 Alice Chen                  4.5 Outstanding         
 2 Bob Martinez                4.8 Outstanding         
 3 Charlie Kim                 3.8 Exceeds Expectations
 4 Diana Patel                 4.2 Exceeds Expectations
 5 Eve Thompson                4.6 Outstanding         
 6 Frank Liu                   3.2 Meets Expectations  
 7 Grace Okonkwo               4.4 Exceeds Expectations
 8 Henry Wang                  4.3 Exceeds Expectations
 9 Iris Nakamura               3.9 Exceeds Expectations
10 Jack Brown                  3.5 Exceeds Expectations
# ℹ 40 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>employees_cat <span class="sc">%&gt;%</span> <span class="fu">count</span>(performance_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  performance_category     n
  &lt;chr&gt;                &lt;int&gt;
1 Exceeds Expectations    31
2 Meets Expectations       9
3 Outstanding             10</code></pre>
</div>
</div>
</section>
<section id="m-experience-level" class="level3">
<h3 class="anchored" data-anchor-id="m-experience-level">m) Experience level</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>employees_exp <span class="ot">&lt;-</span> employees <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">experience_level =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    years_exp <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Entry"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    years_exp <span class="sc">&lt;=</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"Mid"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    years_exp <span class="sc">&lt;=</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"Senior"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Expert"</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>employees_exp <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, years_exp, experience_level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 3
   name          years_exp experience_level
   &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;           
 1 Alice Chen            8 Senior          
 2 Bob Martinez         12 Senior          
 3 Charlie Kim           2 Entry           
 4 Diana Patel           7 Mid             
 5 Eve Thompson         15 Expert          
 6 Frank Liu             1 Entry           
 7 Grace Okonkwo         9 Senior          
 8 Henry Wang           10 Senior          
 9 Iris Nakamura         6 Mid             
10 Jack Brown            2 Entry           
# ℹ 40 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>employees_exp <span class="sc">%&gt;%</span> <span class="fu">count</span>(experience_level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  experience_level     n
  &lt;chr&gt;            &lt;int&gt;
1 Entry               14
2 Expert               5
3 Mid                 15
4 Senior              16</code></pre>
</div>
</div>
</section>
<section id="n-high-performer-flag" class="level3">
<h3 class="anchored" data-anchor-id="n-high-performer-flag">n) High performer flag</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_high_performer =</span> performance_score <span class="sc">&gt;</span> <span class="fl">4.0</span> <span class="sc">&amp;</span> projects_completed <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_high_performer) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, department, performance_score, projects_completed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 4
   name          department  performance_score projects_completed
   &lt;chr&gt;         &lt;chr&gt;                   &lt;dbl&gt;              &lt;int&gt;
 1 Alice Chen    Engineering               4.5                 15
 2 Bob Martinez  Engineering               4.8                 22
 3 Diana Patel   Engineering               4.2                 12
 4 Eve Thompson  Engineering               4.6                 28
 5 Grace Okonkwo Engineering               4.4                 16
 6 Henry Wang    Marketing                 4.3                 18
 7 Kate Wilson   Marketing                 4.5                 24
 8 Nathan Lee    Sales                     4.7                 21
 9 Olivia Davis  Sales                     4.1                 14
10 Rachel Green  Sales                     4.4                 25
# ℹ 13 more rows</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-1.5-aggregation-and-grouping-15-points" class="level2">
<h2 class="anchored" data-anchor-id="question-1.5-aggregation-and-grouping-15-points">Question 1.5: Aggregation and Grouping (15 points)</h2>
<section id="o-company-wide-summary" class="level3">
<h3 class="anchored" data-anchor-id="o-company-wide-summary">o) Company-wide summary</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_employees =</span> <span class="fu">n</span>(),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_salary =</span> <span class="fu">mean</span>(salary),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_performance =</span> <span class="fu">mean</span>(performance_score),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_projects =</span> <span class="fu">sum</span>(projects_completed)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  total_employees avg_salary avg_performance total_projects
            &lt;int&gt;      &lt;dbl&gt;           &lt;dbl&gt;          &lt;int&gt;
1              50      86420            3.97            612</code></pre>
</div>
</div>
</section>
<section id="p-summary-by-department" class="level3">
<h3 class="anchored" data-anchor-id="p-summary-by-department">p) Summary by department</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_salary =</span> <span class="fu">mean</span>(salary),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_perf =</span> <span class="fu">mean</span>(performance_score),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_exp =</span> <span class="fu">min</span>(years_exp),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_exp =</span> <span class="fu">max</span>(years_exp)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  department  count avg_salary avg_perf min_exp max_exp
  &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;
1 Engineering    12     98417.     4.25       1      16
2 Finance         9     86333.     3.96       1      14
3 HR              9     75556.     3.76       1      12
4 Marketing      10     80700      3.86       1      14
5 Sales          10     87600      3.95       1      13</code></pre>
</div>
</div>
</section>
<section id="q-summary-by-department-and-role" class="level3">
<h3 class="anchored" data-anchor-id="q-summary-by-department-and-role">q) Summary by department and role</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dept_role <span class="ot">&lt;-</span> employees <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department, role) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_salary =</span> <span class="fu">mean</span>(salary), <span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_salary))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>dept_role</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 4
   department  role    avg_salary count
   &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;
 1 Engineering Manager    142500      2
 2 Finance     Manager    135000      1
 3 Sales       Manager    130000      1
 4 Marketing   Manager    125000      1
 5 Engineering Lead       119000      2
 6 Sales       Lead       113500      2
 7 HR          Manager    110000      1
 8 Finance     Lead       105000      2
 9 Marketing   Lead       102500      2
10 HR          Lead        93500      2
11 Engineering Senior      93400      5
12 Sales       Senior      87250      4
13 Finance     Senior      85667.     3
14 Marketing   Senior      79000      4
15 HR          Senior      71250      4
16 Engineering Junior      63667.     3
17 Finance     Junior      58333.     3
18 Sales       Junior      56667.     3
19 Marketing   Junior      53667.     3
20 HR          Junior      49000      2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Highest combo:</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>dept_role <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  department  role    avg_salary count
  &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;
1 Engineering Manager     142500     2</code></pre>
</div>
</div>
<p>The highest average salary is in the department-role combo shown above.</p>
</section>
<section id="r-salary-as-of-department-average" class="level3">
<h3 class="anchored" data-anchor-id="r-salary-as-of-department-average">r) Salary as % of department average</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dept_avg =</span> <span class="fu">mean</span>(salary),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_of_avg =</span> salary <span class="sc">/</span> dept_avg <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pct_of_avg)) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, department, salary, dept_avg, pct_of_avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 5
   name          department  salary dept_avg pct_of_avg
   &lt;chr&gt;         &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 Bella Moore   Finance     135000   86333.       156.
 2 Kate Wilson   Marketing   125000   80700        155.
 3 Rachel Green  Sales       130000   87600        148.
 4 Paula Hughes  Engineering 145000   98417.       147.
 5 Wendy Clark   HR          110000   75556.       146.
 6 Eve Thompson  Engineering 140000   98417.       142.
 7 Nathan Lee    Sales       115000   87600        131.
 8 Henry Wang    Marketing   105000   80700        130.
 9 Rosa Martinez Sales       112000   87600        128.
10 Tina White    HR           95000   75556.       126.
# ℹ 40 more rows</code></pre>
</div>
</div>
<p>The person at the top earns the most relative to their department’s average.</p>
</section>
<section id="s-top-3-departments-by-performance-3-years-exp" class="level3">
<h3 class="anchored" data-anchor-id="s-top-3-departments-by-performance-3-years-exp">s) Top 3 departments by performance (3+ years exp)</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>employees <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(years_exp <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_perf =</span> <span class="fu">mean</span>(performance_score)) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_perf)) <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  department  avg_perf
  &lt;chr&gt;          &lt;dbl&gt;
1 Engineering     4.4 
2 Finance         4.3 
3 Sales           4.15</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="part-2-social-network-analysis-45-points" class="level1">
<h1>Part 2: Social Network Analysis (45 points)</h1>
<section id="question-2.1-network-construction-and-visualization-10-points" class="level2">
<h2 class="anchored" data-anchor-id="question-2.1-network-construction-and-visualization-10-points">Question 2.1: Network Construction and Visualization (10 points)</h2>
<section id="t-load-network-data" class="level3">
<h3 class="anchored" data-anchor-id="t-load-network-data">t) Load network data</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>email_nodes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/email_nodes.csv"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>email_edges <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/email_edges.csv"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(email_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id  department    role
1  1 Engineering  Senior
2  2 Engineering    Lead
3  3 Engineering  Junior
4  4 Engineering  Senior
5  5 Engineering Manager
6  6 Engineering  Junior</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(email_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  from to weight
1    1  2     25
2    1  3     15
3    1  4     20
4    1  5     30
5    1  7     18
6    2  3     22</code></pre>
</div>
</div>
</section>
<section id="u-construct-undirected-graph" class="level3">
<h3 class="anchored" data-anchor-id="u-construct-undirected-graph">u) Construct undirected graph</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>email_graph <span class="ot">&lt;-</span> <span class="fu">graph.data.frame</span>(email_edges, <span class="at">vertices =</span> email_nodes, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nodes:"</span>, <span class="fu">vcount</span>(email_graph), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nodes: 50 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Edges:"</span>, <span class="fu">ecount</span>(email_graph), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Edges: 207 </code></pre>
</div>
</div>
</section>
<section id="v-basic-and-improved-plots" class="level3">
<h3 class="anchored" data-anchor-id="v-basic-and-improved-plots">v) Basic and improved plots</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(email_graph, <span class="at">main =</span> <span class="st">"Basic"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>deg <span class="ot">&lt;-</span> <span class="fu">degree</span>(email_graph)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(email_graph, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">sqrt</span>(deg) <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="st">"Improved"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Assignment1_files/figure-html/q2.1v-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The improved version removes the messy labels and sizes nodes by how connected they are.</p>
</section>
<section id="w-department-colored-network" class="level3">
<h3 class="anchored" data-anchor-id="w-department-colored-network">w) Department-colored network</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>depts <span class="ot">&lt;-</span> <span class="fu">V</span>(email_graph)<span class="sc">$</span>department</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>unique_depts <span class="ot">&lt;-</span> <span class="fu">unique</span>(depts)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(unique_depts), <span class="st">"Set1"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(colors) <span class="ot">&lt;-</span> unique_depts</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(email_graph, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">sqrt</span>(deg) <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> colors[depts], <span class="at">edge.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"By Department"</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, unique_depts, <span class="at">fill =</span> colors, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Assignment1_files/figure-html/q2.1w-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-2.2-connected-components-8-points" class="level2">
<h2 class="anchored" data-anchor-id="question-2.2-connected-components-8-points">Question 2.2: Connected Components (8 points)</h2>
<section id="x-find-connected-components" class="level3">
<h3 class="anchored" data-anchor-id="x-find-connected-components">x) Find connected components</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">components</span>(email_graph)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of components:"</span>, comp<span class="sc">$</span>no, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of components: 1 </code></pre>
</div>
</div>
</section>
<section id="y-largest-component-size" class="level3">
<h3 class="anchored" data-anchor-id="y-largest-component-size">y) Largest component size</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>lcc_size <span class="ot">&lt;-</span> <span class="fu">max</span>(comp<span class="sc">$</span>csize)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Largest component:"</span>, lcc_size, <span class="st">"employees</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Largest component: 50 employees</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"That's"</span>, <span class="fu">round</span>(lcc_size <span class="sc">/</span> <span class="fu">vcount</span>(email_graph) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% of everyone</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>That's 100 % of everyone</code></pre>
</div>
</div>
</section>
<section id="z-extract-and-plot-largest-component" class="level3">
<h3 class="anchored" data-anchor-id="z-extract-and-plot-largest-component">z) Extract and plot largest component</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>lcc_id <span class="ot">&lt;-</span> <span class="fu">which.max</span>(comp<span class="sc">$</span>csize)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>lcc_nodes <span class="ot">&lt;-</span> <span class="fu">which</span>(comp<span class="sc">$</span>membership <span class="sc">==</span> lcc_id)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>lcc <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(email_graph, lcc_nodes)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"LCC has"</span>, <span class="fu">vcount</span>(lcc), <span class="st">"nodes and"</span>, <span class="fu">ecount</span>(lcc), <span class="st">"edges</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LCC has 50 nodes and 207 edges</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>deg_lcc <span class="ot">&lt;-</span> <span class="fu">degree</span>(lcc)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>depts_lcc <span class="ot">&lt;-</span> <span class="fu">V</span>(lcc)<span class="sc">$</span>department</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lcc, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">vertex.size =</span> <span class="fu">sqrt</span>(deg_lcc) <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> colors[depts_lcc], <span class="at">edge.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Largest Connected Component"</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, unique_depts, <span class="at">fill =</span> colors, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Assignment1_files/figure-html/q2.2z-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="aa-why-use-the-largest-connected-component" class="level3">
<h3 class="anchored" data-anchor-id="aa-why-use-the-largest-connected-component">aa) Why use the largest connected component?</h3>
<p>For closeness centrality, you need every node to be reachable from every other node. If the graph is disconnected, some distances become infinite and the calculation breaks. Using just the largest component avoids this problem and gives us meaningful values to work with.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-2.3-centrality-metrics-15-points" class="level2">
<h2 class="anchored" data-anchor-id="question-2.3-centrality-metrics-15-points">Question 2.3: Centrality Metrics (15 points)</h2>
<section id="bb-degree-centrality" class="level3">
<h3 class="anchored" data-anchor-id="bb-degree-centrality">bb) Degree Centrality</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>deg_cent <span class="ot">&lt;-</span> <span class="fu">degree</span>(lcc)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>deg_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">as.integer</span>(<span class="fu">V</span>(lcc)<span class="sc">$</span>name), <span class="at">degree =</span> deg_cent) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(degree))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top 5 by degree:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 by degree:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(deg_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id degree
5   5     20
28 28     20
11 11     18
18 18     18
23 23     18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lcc, <span class="at">vertex.label =</span> <span class="fu">V</span>(lcc)<span class="sc">$</span>name, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> deg_cent <span class="sc">*</span> <span class="fl">1.5</span>, <span class="at">vertex.color =</span> colors[depts_lcc],</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="st">"Sized by Degree"</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, unique_depts, <span class="at">fill =</span> colors, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Assignment1_files/figure-html/q2.3bb-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cc-closeness-centrality" class="level3">
<h3 class="anchored" data-anchor-id="cc-closeness-centrality">cc) Closeness Centrality</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>close_cent <span class="ot">&lt;-</span> <span class="fu">closeness</span>(lcc, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>close_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">as.integer</span>(<span class="fu">V</span>(lcc)<span class="sc">$</span>name), <span class="at">closeness =</span> close_cent) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(closeness))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top 5 by closeness:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 by closeness:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(close_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id  closeness
5   5 0.02985984
25 25 0.02925373
14 14 0.02920143
11 11 0.02884049
28 28 0.02719201</code></pre>
</div>
</div>
<p>High closeness means you can reach everyone else pretty quickly - you’re not stuck in a corner of the network. These people are good for spreading info fast since they’re “close” to everyone.</p>
</section>
<section id="dd-betweenness-centrality" class="level3">
<h3 class="anchored" data-anchor-id="dd-betweenness-centrality">dd) Betweenness Centrality</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>btw_cent <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(lcc, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>btw_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">as.integer</span>(<span class="fu">V</span>(lcc)<span class="sc">$</span>name), <span class="at">betweenness =</span> btw_cent) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(betweenness))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top 5 by betweenness:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 by betweenness:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(btw_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id betweenness
14 14   0.3380244
5   5   0.2884010
25 25   0.2833759
23 23   0.2789116
2   2   0.2268282</code></pre>
</div>
</div>
<p>Betweenness measures how often someone sits on the shortest path between other people. High betweenness = you’re a bridge or connector. These folks control info flow - if they don’t pass something along, it might not get where it needs to go.</p>
</section>
<section id="ee-pagerank" class="level3">
<h3 class="anchored" data-anchor-id="ee-pagerank">ee) PageRank</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">page_rank</span>(lcc)<span class="sc">$</span>vector</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>pr_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">as.integer</span>(<span class="fu">V</span>(lcc)<span class="sc">$</span>name), <span class="at">pagerank =</span> pr) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pagerank))</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top 5 by PageRank:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 by PageRank:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pr_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id   pagerank
5   5 0.04219373
23 23 0.04049384
28 28 0.03937716
18 18 0.03930274
11 11 0.03894129</code></pre>
</div>
</div>
<p>PageRank is different from degree because it cares about <em>who</em> you’re connected to. Being friends with popular people boosts your score more than being friends with people no one else talks to. It’s about influence, not just connection count.</p>
</section>
<section id="ff-comparing-all-metrics" class="level3">
<h3 class="anchored" data-anchor-id="ff-comparing-all-metrics">ff) Comparing all metrics</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>all_cent <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">as.integer</span>(<span class="fu">V</span>(lcc)<span class="sc">$</span>name),</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dept =</span> <span class="fu">V</span>(lcc)<span class="sc">$</span>department,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">role =</span> <span class="fu">V</span>(lcc)<span class="sc">$</span>role,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> deg_cent,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">closeness =</span> close_cent,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">betweenness =</span> btw_cent,</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pagerank =</span> pr</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> all_cent <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(degree)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>top10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id        dept    role degree  closeness betweenness   pagerank
5   5 Engineering Manager     20 0.02985984 0.288400956 0.04219373
28 28     Finance Manager     20 0.02719201 0.115949951 0.03937716
11 11   Marketing Manager     18 0.02884049 0.160501701 0.03894129
18 18       Sales Manager     18 0.02606383 0.046541950 0.03930274
23 23          HR Manager     18 0.02603613 0.278911565 0.04049384
2   2 Engineering    Lead     12 0.02704194 0.226828231 0.03100845
7   7 Engineering  Senior     11 0.01952969 0.005668934 0.02454985
25 25     Finance    Lead     11 0.02925373 0.283375850 0.02689045
9   9   Marketing  Senior     10 0.01954527 0.068664966 0.02448814
14 14       Sales    Lead     10 0.02920143 0.338024376 0.02545679</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rankings</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>top10 <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">deg_r =</span> <span class="fu">rank</span>(<span class="sc">-</span>degree),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">close_r =</span> <span class="fu">rank</span>(<span class="sc">-</span>closeness),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">btw_r =</span> <span class="fu">rank</span>(<span class="sc">-</span>betweenness),</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pr_r =</span> <span class="fu">rank</span>(<span class="sc">-</span>pagerank)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, deg_r, close_r, btw_r, pr_r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id deg_r close_r btw_r pr_r
5   5   1.5       1     2    1
28 28   1.5       5     7    3
11 11   4.0       4     6    5
18 18   4.0       7     9    4
23 23   4.0       8     4    2
2   2   6.0       6     5    6
7   7   7.5      10    10    9
25 25   7.5       2     3    7
9   9   9.5       9     8   10
14 14   9.5       3     1    8</code></pre>
</div>
</div>
<p>Some people rank high on everything - they’re the real network stars. Others might have high betweenness but only moderate degree, meaning they’re important bridges even without tons of connections. You can also see that managers/leads tend to show up more, which makes sense given their coordinating role.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-2.4-community-detection-12-points" class="level2">
<h2 class="anchored" data-anchor-id="question-2.4-community-detection-12-points">Question 2.4: Community Detection (12 points)</h2>
<section id="gg-spinglass-clustering" class="level3">
<h3 class="anchored" data-anchor-id="gg-spinglass-clustering">gg) Spinglass clustering</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>comm <span class="ot">&lt;-</span> <span class="fu">cluster_spinglass</span>(lcc)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Communities found:"</span>, <span class="fu">length</span>(comm), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Communities found: 5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Modularity:"</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(comm), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modularity: 0.028 </code></pre>
</div>
</div>
</section>
<section id="hh-community-sizes" class="level3">
<h3 class="anchored" data-anchor-id="hh-community-sizes">hh) Community sizes</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>mem <span class="ot">&lt;-</span> <span class="fu">membership</span>(comm)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mem
 1  2  3  4  5 
10 10 12  9  9 </code></pre>
</div>
</div>
</section>
<section id="ii-visualize-by-community" class="level3">
<h3 class="anchored" data-anchor-id="ii-visualize-by-community">ii) Visualize by community</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>num_comm <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(mem))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>comm_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">max</span>(<span class="dv">3</span>, num_comm), <span class="st">"Set2"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lcc, <span class="at">vertex.label =</span> <span class="fu">V</span>(lcc)<span class="sc">$</span>name, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="dv">10</span>, <span class="at">vertex.color =</span> comm_colors[mem],</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="st">"By Community"</span>)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="fu">paste</span>(<span class="st">"Comm"</span>, <span class="dv">1</span><span class="sc">:</span>num_comm), <span class="at">fill =</span> comm_colors[<span class="dv">1</span><span class="sc">:</span>num_comm],</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Assignment1_files/figure-html/q2.4ii-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="jj-community-vs-department" class="level3">
<h3 class="anchored" data-anchor-id="jj-community-vs-department">jj) Community vs Department</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>comm_dept <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">as.integer</span>(<span class="fu">V</span>(lcc)<span class="sc">$</span>name),</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">community =</span> mem,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">department =</span> <span class="fu">V</span>(lcc)<span class="sc">$</span>department</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>xtab <span class="ot">&lt;-</span> <span class="fu">table</span>(comm_dept<span class="sc">$</span>community, comm_dept<span class="sc">$</span>department)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>xtab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    Engineering Finance HR Marketing Sales
  1           0       0  0         0    10
  2           0       0  0        10     0
  3          12       0  0         0     0
  4           0       9  0         0     0
  5           0       0  9         0     0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Percentages:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(xtab, <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    Engineering Finance  HR Marketing Sales
  1           0       0   0         0   100
  2           0       0   0       100     0
  3         100       0   0         0     0
  4           0     100   0         0     0
  5           0       0 100         0     0</code></pre>
</div>
</div>
<p>The communities don’t match up perfectly with departments. Some communities have people from multiple departments, which shows there’s cross-team communication happening. That’s generally a good thing - it means people aren’t just stuck in their own silos.</p>
</section>
<section id="kk-business-insights" class="level3">
<h3 class="anchored" data-anchor-id="kk-business-insights">kk) Business insights</h3>
<p>A few things management could take from this:</p>
<ul>
<li>The communities show how people actually communicate, not just how the org chart says they should</li>
<li>People who bridge multiple communities are valuable - they help different groups stay connected</li>
<li>If a community is 100% one department, that might be a warning sign of a silo</li>
<li>When planning changes or announcements, it’s smart to work with community leaders to spread the word effectively</li>
</ul>
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="part-3-integration-and-insights-10-points" class="level1">
<h1>Part 3: Integration and Insights (10 points)</h1>
<section id="question-3.1-joining-data-5-points" class="level2">
<h2 class="anchored" data-anchor-id="question-3.1-joining-data-5-points">Question 3.1: Joining Data (5 points)</h2>
<section id="ll-join-employee-data-with-centrality-metrics" class="level3">
<h3 class="anchored" data-anchor-id="ll-join-employee-data-with-centrality-metrics">ll) Join employee data with centrality metrics</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>cent_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="fu">as.integer</span>(<span class="fu">V</span>(lcc)<span class="sc">$</span>name),</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> <span class="fu">degree</span>(lcc),</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">closeness =</span> <span class="fu">closeness</span>(lcc, <span class="at">normalized =</span> <span class="cn">TRUE</span>),</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">betweenness =</span> <span class="fu">betweenness</span>(lcc, <span class="at">normalized =</span> <span class="cn">TRUE</span>),</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pagerank =</span> <span class="fu">page_rank</span>(lcc)<span class="sc">$</span>vector</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> employees <span class="sc">%&gt;%</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(cent_df, <span class="at">by =</span> <span class="st">"employee_id"</span>)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">%&gt;%</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(employee_id, name, department, performance_score,</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>         degree, closeness, betweenness, pagerank) <span class="sc">%&gt;%</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 8
   employee_id name    department performance_score degree closeness betweenness
         &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;                  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1           1 Alice … Engineeri…               4.5      9    0.0203     0.0286 
 2           2 Bob Ma… Engineeri…               4.8     12    0.0270     0.227  
 3           3 Charli… Engineeri…               3.8      7    0.0188     0.0799 
 4           4 Diana … Engineeri…               4.2      8    0.0198     0.0197 
 5           5 Eve Th… Engineeri…               4.6     20    0.0299     0.288  
 6           6 Frank … Engineeri…               3.2      4    0.0164     0      
 7           7 Grace … Engineeri…               4.4     11    0.0195     0.00567
 8           8 Henry … Marketing                4.3      8    0.0230     0.112  
 9           9 Iris N… Marketing                3.9     10    0.0195     0.0687 
10          10 Jack B… Marketing                3.5      6    0.0173     0.0799 
# ℹ 1 more variable: pagerank &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="mm-correlation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="mm-correlation-analysis">mm) Correlation analysis</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree vs Performance:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(combined<span class="sc">$</span>degree, combined<span class="sc">$</span>performance_score), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Degree vs Performance: 0.691 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Closeness vs Performance:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(combined<span class="sc">$</span>closeness, combined<span class="sc">$</span>performance_score), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Closeness vs Performance: 0.702 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Betweenness vs Performance:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(combined<span class="sc">$</span>betweenness, combined<span class="sc">$</span>performance_score), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Betweenness vs Performance: 0.477 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"PageRank vs Performance:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(combined<span class="sc">$</span>pagerank, combined<span class="sc">$</span>performance_score), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PageRank vs Performance: 0.745 </code></pre>
</div>
</div>
<p>There’s some relationship between network position and performance, but it’s not super strong. Being well-connected might help with performance, or maybe high performers naturally end up more connected. Either way, it’s not the whole story - plenty of other factors matter too.</p>
</section>
<section id="nn-high-performers-with-low-centrality" class="level3">
<h3 class="anchored" data-anchor-id="nn-high-performers-with-low-centrality">nn) High performers with low centrality</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>med_deg <span class="ot">&lt;-</span> <span class="fu">median</span>(combined<span class="sc">$</span>degree)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median degree:"</span>, med_deg, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median degree: 7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(performance_score <span class="sc">&gt;</span> <span class="fl">4.0</span> <span class="sc">&amp;</span> degree <span class="sc">&lt;</span> med_deg) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(employee_id, name, department, role, performance_score, degree, projects_completed) <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(performance_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  employee_id name  department role  performance_score degree projects_completed
        &lt;int&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;              &lt;int&gt;
1          46 Tara… Finance    Lead                4.3      6                 17</code></pre>
</div>
</div>
<p>These are people doing great work but flying under the radar network-wise. They might be specialists who don’t need to talk to everyone, or just more introverted. Management should make sure these folks aren’t getting overlooked for promotions just because they’re not as visible in the network.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="question-3.2-executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="question-3.2-executive-summary">Question 3.2: Executive Summary</h2>
<section id="executive-summary-for-techconnect-management" class="level3">
<h3 class="anchored" data-anchor-id="executive-summary-for-techconnect-management">Executive Summary for TechConnect Management</h3>
<p><strong>Overview</strong></p>
<p>We analyzed TechConnect’s employee data and email communication patterns to understand performance trends and how information flows through the organization.</p>
<p><strong>Performance Findings</strong></p>
<p>The company’s average performance score is 3.97 out of 5, which is pretty solid. Across all departments, employees have completed 612 projects total. We found 23 people who are standout performers - scoring above 4.0 and completing 10+ projects each. There’s some variation between departments, but overall the workforce is performing well.</p>
<p><strong>Network Structure</strong></p>
<p>Looking at email patterns, 50 out of 50 employees are in the main communication cluster. The network shows that people don’t just talk within their own departments - there’s a fair amount of cross-team communication. The communities we detected overlap with departments but aren’t a perfect match, which suggests people are collaborating across org boundaries.</p>
<p><strong>Key People</strong></p>
<p>A few employees stand out as communication hubs: Nathan Lee, Eve Thompson, Yuki Tanaka. These folks have high betweenness centrality, meaning they connect different parts of the organization. If one of them left, it could seriously disrupt how information gets around.</p>
<p><strong>Recommendations</strong></p>
<ol type="1">
<li><p><strong>Use your connectors</strong> - The people with high betweenness are natural choices for spreading important updates or leading cross-functional projects.</p></li>
<li><p><strong>Watch for silos</strong> - If any department starts communicating only internally, that’s worth addressing before it becomes a problem.</p></li>
<li><p><strong>Don’t forget the quiet high performers</strong> - Some of your best people aren’t super networked. Make sure they’re still getting recognized and considered for advancement.</p></li>
<li><p><strong>Plan for departures</strong> - If a key bridge person leaves, have a backup plan. Maybe cross-train people or build redundant communication paths.</p></li>
<li><p><strong>Think about teams</strong> - When putting together project teams, consider who already talks to whom. Natural communication patterns can make collaboration smoother.</p></li>
</ol>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>